<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë°˜ë³µ ì•ŒëŒ</title>
<style>
    body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; padding: 20px; background: #f5f5f7; }
    h1 { text-align: center; }
    .card { background: white; border-radius: 12px; padding: 20px; max-width: 400px; margin: auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 15px; font-weight: bold; }
    select, input, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
    button { background: #007aff; color: white; border: none; cursor: pointer; }
    button:hover { background: #005ecb; }
</style>
</head>
<body>

<h1>ë°˜ë³µ ì•ŒëŒ ì„¤ì •</h1>
<div class="card">
    <label>ì‹œê°„ ê°’</label>
    <input type="number" id="timeValue" min="1" max="60" value="30">

    <label>ì‹œê°„ ë‹¨ìœ„</label>
    <select id="timeUnit">
        <option value="sec">ì´ˆ</option>
        <option value="min">ë¶„</option>
        <option value="hour">ì‹œê°„</option>
    </select>

    <label>ì•ŒëŒ ì‚¬ìš´ë“œ</label>
    <select id="soundSelect">
        <option value="radar_like.mp3">Radar ìŠ¤íƒ€ì¼</option>
        <option value="beacon_like.mp3">Beacon ìŠ¤íƒ€ì¼</option>
        <option value="chime_like.mp3">Chime ìŠ¤íƒ€ì¼</option>
    </select>

    <button onclick="startAlarm()">ì•ŒëŒ ì‹œì‘</button>
    <button onclick="stopAlarm()" style="background:#ff3b30; margin-top:10px;">ì•ŒëŒ ì¤‘ì§€</button>
</div>

<script>
let alarmAudio = null;
let alarmInterval = null;

function startAlarm() {
    stopAlarm(); // ê¸°ì¡´ ì•ŒëŒ ì¤‘ì§€

    const value = parseInt(document.getElementById('timeValue').value);
    const unit = document.getElementById('timeUnit').value;
    const sound = document.getElementById('soundSelect').value;

    let seconds = value;
    if (unit === 'min') seconds *= 60;
    else if (unit === 'hour') seconds *= 3600;

    // ì˜¤ë””ì˜¤ ê°ì²´ ì¤€ë¹„ (ì‚¬ìš©ì í´ë¦­ ì‹œ 1íšŒ ì¬ìƒ í—ˆìš©)
    alarmAudio = new Audio(sound);
    alarmAudio.loop = true;

    // Safariê°€ í—ˆìš©í•˜ë„ë¡ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì•ˆì—ì„œ ë¨¼ì € ì‹¤í–‰
    alarmAudio.play().then(() => {
        alarmAudio.pause();
        alarmAudio.currentTime = 0;

        // ì•ŒëŒ ì‹¤í–‰ ë£¨í”„
        alarmInterval = setInterval(() => {
            alarmAudio.currentTime = 0;
            alarmAudio.play();

            // 5ì´ˆ í›„ ìë™ ì •ì§€
            setTimeout(() => {
                alarmAudio.pause();
                alarmAudio.currentTime = 0;
            }, 5000);

        }, seconds * 1000);

        alert(`â° ì•ŒëŒì´ ${seconds}ì´ˆë§ˆë‹¤ 5ì´ˆê°„ ìš¸ë¦½ë‹ˆë‹¤.`);
    }).catch(err => {
        console.log("Safariì—ì„œ ì˜¤ë””ì˜¤ ì‹œì‘ ì‹¤íŒ¨:", err);
        alert("ğŸ”‡ Safariì—ì„œ ì²« ì¬ìƒì´ í—ˆìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.");
    });
}

function stopAlarm() {
    if (alarmInterval) {
        clearInterval(alarmInterval);
        alarmInterval = null;
    }
    if (alarmAudio) {
        alarmAudio.pause();
        alarmAudio.currentTime = 0;
    }
    alert("ì•ŒëŒì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.");
}
</script>

</body>
</html>
